@using KEC.Curation.UI.Models;
@model ChiefCurators
@{
    ViewBag.Title = "PrincipalCurator";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section Scripts
{



    <script src="~/Scripts/plugins/typehead/bootstrap3-typeahead.min.js"></script>
    <script type="text/javascript">
        let userGuid = $('#CurrentUserGuid').val();
        let assignmentUrl = apiBaseUrl.concat(`/chiefcurator/curator/tocurate?userGuid=${userGuid}`);
        function tableRows(data) {
            var tableRows = [];
            for (var i = 0; i < data.length; i++) {
                tableRows.push(drawRow(data[i]));
            }
            return tableRows;
        };


        //Start by getting publication list based on Payment Verification Stage
        $.ajax({
            url: assignmentUrl,
            type: "GET",
            dataType: 'json',
            success: function (data, status, jqhxr) {
                console.log(data);

                //This code snipet prepares to append Json Data
                $('#unassigned-publications').append(tableRows(data));
            }
        });

        //This functionpopulates the tbody inner HTML with json data on call
        function drawRow(rowData) {
            var row = $("<tr />")
            row.append($("<td>" + rowData.assignmentId + "</td>"));
            row.append($("<td>" + rowData.publication + "</td>"));
            row.append($("<td>" + rowData.sectionToCurate + "</td>"));
            row.append($("<td>" + rowData.assignmentDateUtc + "</td>"));
            row.append($(`<td> <a href="/Curator/CuratePublication/${rowData.assignmentId}" class="btn btn-w-m btn-info" style="background-color:#00B95F;" role="button">Curate</a>`));

            return row[0];
        };
    </script>



}

<div class="text-center m-t-lg">
    <h1>
        @ViewData["SubTitle"]
    </h1>
    <small>@ViewData["Message"]</small>
</div>
<div class="tabs-container">
    <ul class="nav nav-tabs">
        <li class="active"><a data-toggle="tab" href="#tab-unassigned" style="background-color:#1C84C6; color:white;" aria-expanded="true">Assigned Publications</a></li>
        @*<li class=""><a href="/PrincipalCurator/PrincipalCuratorReverse" style="background-color:#000000; color:white;"> Reverse Assignment</a></li>*@
    </ul>
    <div class="tab-content">
        <div id="tab-unassigned" class="tab-pane active">
            <div class="panel-body">
                <div class="wrapper wrapper-content animated fadeInRight">
                    <div class="row">
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="ibox float-e-margins">

                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="ibox float-e-margins">
                                    <div class="ibox-title">
                                        <h5>Listing Assigned Publications</h5>
                                    </div>
                                    <div class="ibox-content">
                                        <div class="table-responsive">
                                            <table class="table table-striped table-bordered table-hover dataTables-example" id="unassigned-publications">
                                                <thead>
                                                    <tr>
                                                        <th>ID</th>
                                                        <th>Title</th>
                                                        <th>Description</th>
                                                        <th>Curation Number</th>
                                                        <th>Action</th>
                                                    </tr>
                                                </thead>
                                                <tbody></tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="tab-assigned" class="tab-pane">
            <div class="panel-body">
                <div class="wrapper wrapper-content animated fadeInRight">
                    <div class="row">
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="ibox float-e-margins">

                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="ibox float-e-margins">
                                    <div class="ibox-title">
                                        <h5>Listing Assigned Publications</h5>
                                    </div>
                                    <div class="ibox-content">
                                        <div class="table-responsive">
                                            <table class="table table-striped table-bordered table-hover dataTables-example" id="assigned-publications">
                                                <thead>
                                                    <tr>
                                                        <th class="hidden">Id</th>
                                                        <th>Title</th>
                                                        <th>Curation Number</th>
                                                        <th>Action</th>

                                                    </tr>
                                                </thead>
                                                <tbody></tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="tab-history" class="tab-pane">
            <div class="panel-body">
                <div class="wrapper wrapper-content animated fadeInRight">
                    <div class="row">
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="ibox float-e-margins">

                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="ibox float-e-margins">
                                    <div class="ibox-title">
                                        <h5>Reverse Assignment Here</h5>
                                    </div>
                                    <div class="ibox-content">
                                        <div class="table-responsive">
                                            <table class="table table-striped table-bordered table-hover dataTables-example" id="history-publications">
                                                <thead>
                                                    <tr>
                                                        <th class="hidden">ID</th>
                                                        <th>Title</th>
                                                        <th>Curation Number</th>
                                                        <th>Assignee</th>
                                                        <th>Action</th>
                                                    </tr>
                                                </thead>
                                                <tbody></tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
<div class="form-group col-md-10">
    <input type="text" name="CurrentUserGuid" id="CurrentUserGuid" class="form-control hidden" value="@Model.Guid">
</div>
<div class="form-group col-md-10">
    <input type="text" name="SubjectId" id="SubjectId" class="form-control hidden" value="@Model.Subjectid">
</div>
